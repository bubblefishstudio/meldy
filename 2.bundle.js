(window.webpackJsonp=window.webpackJsonp||[]).push([[2,4],[,,function(t,s,e){"use strict";e.r(s),s.default=class{constructor(t,s,i){this.navigator=t,this.data=s,this.view=e(5)(`./${i}.html`).default.cloneNode(!0)}setup(){}}},,function(t,s,e){"use strict";e.r(s);var i=e(9),n=e.n(i);let r;class a{constructor(){this.w=0,this.h=0,this.x=0,this.y=0}setSize(t,s){return this.w=t,this.h=s,this}setPosition(t,s){return this.x=t,this.y=s,this}isOver(){return r.mouseX>this.x&&r.mouseX<this.x+this.w&&r.mouseY>this.y&&r.mouseY<this.y+this.h}}var h;!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(h||(h={}));class o extends a{constructor(t,s,e,i){super(),this.thumb_d=30,this.thumb_x=new u(t,s,e),this.thumb_y=new u(t,s,e),this.thumb_d=i}setValue(t,s){let e=this.thumb_x.setValue(t),i=this.thumb_y.setValue(s);this.onChange&&(e||i)&&this.onChange(this)}getValue(){return[this.thumb_x.v,this.thumb_y.v]}update(){this.isOver()&&r.mouseIsPressed&&this.setValue(this.thumb_x.position2value(r.mouseX,this.startX,this.endX),this.thumb_y.position2value(r.mouseY,this.startY,this.endY)),this.thumb_x.update(),this.thumb_y.update()}draw(){this.update(),r.noStroke(),r.fill(0),r.erase(),r.rect(this.x,this.y,this.w,this.h),r.noErase();let t=this.thumb_x.value2position(this.thumb_x.drawn_v,this.startX,this.endX),s=this.thumb_y.value2position(this.thumb_y.drawn_v,this.startY,this.endY);r.ellipseMode(r.CENTER),r.ellipse(t,s,this.thumb_d,this.thumb_d)}get startX(){return this.x+this.thumb_d/2}get endX(){return this.x+this.w-this.thumb_d/2}get startY(){return this.y+this.h-this.thumb_d/2}get endY(){return this.y+this.thumb_d/2}}class u{constructor(t,s,e){this.min_v=t,this.max_v=s,this.inertia=e,this.value=this.drawn_value=(this.max_v-this.min_v)/2}get v(){return this.value}set v(t){this.setValue(t)}get drawn_v(){return this.drawn_value}setValue(t){t=this.constrain(t);let s=this.value;return this.value=t,t!=s}update(){this.drawn_value+=(this.value-this.drawn_value)/this.inertia}position2value(t,s,e){let i=this.constrain((t-s)/(e-s),0,1);return(this.max_v-this.min_v)*i+this.min_v}value2position(t,s,e){return(t-this.min_v)/(this.max_v-this.min_v)*(e-s)+s}constrain(t,s=this.min_v,e=this.max_v){return Math.min(Math.max(t,s),e)}}var l=function(t){let s;r=t,t.setup=()=>{t.createCanvas(300,300),s=new o(0,1,2,20),s.setPosition(0,0).setSize(300,300).setValue(.5,.5)},t.draw=()=>{s.draw(),t.stroke(0),t.drawingContext.setLineDash([1,4]),t.line(0,t.height/2,t.width,t.height/2),t.line(t.width/2,0,t.width/2,t.height)},t.readValue=()=>s.getValue()},d=e(2);s.default=class extends d.default{setup(){this.mood_picker=new n.a(l,this.view.querySelector("#mood-picker")),this.view.querySelector("#create").addEventListener("click",()=>this.create_melody())}create_melody(){this.show_error(!1),this.set_loading(!0);let[t,s]=this.mood_picker.readValue();this.fetch_melody(t,s).then(t=>{this.navigator.goto("result",t).then(()=>this.mood_picker.remove())}).catch(t=>{this.set_loading(!1),this.show_error(!0)})}show_error(t){this.view.classList.toggle("error",t),this.removeErrorClass&&clearTimeout(this.removeErrorClass),t&&(this.removeErrorClass=setTimeout(()=>this.view.classList.remove("error"),2e3))}set_loading(t){this.view.classList.toggle("loading",t),this.view.querySelector("#create").disabled=t}async fetch_melody(t,s){try{let e=await fetch(`https://nuvola-ym.herokuapp.com/?valence=${t}&arousal=${s}`);if(e.ok)return e}catch(t){throw new Error(`Cannot reach back-end API (https://nuvola-ym.herokuapp.com/ â†’ http status: ${response.status})`)}}}},function(t,s,e){var i={"./request.html":6,"./result.html":7};function n(t){var s=r(t);return e(s)}function r(t){if(!e.o(i,t)){var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}return i[t]}n.keys=function(){return Object.keys(i)},n.resolve=r,t.exports=n,n.id=5},function(t,s,e){"use strict";e.r(s),s.default=function(){const t=document.createElement("div");return t.innerHTML='<div class="view request-view">\n\n\t<div class="row intro">\n\t\t<span class="description">Today I feel...</span>\n\t</div>\n\n\t<div class="row mood-picker" id="mood-picker">\n\t\t<span class="mood happy-mood">Happy</span>\n\t\t<span class="mood peace-mood">Peaceful</span>\n\t\t<span class="mood upset-mood">Upset</span>\n\t\t<span class="mood sad-mood">Sad</span>\n\t\t\x3c!-- canvas will be attached here --\x3e\n\t</div>\n\n\t<div class="row actions has-icons">\n\t\t<button class="btn btn-go" id="create">Impress me</button>\n\t\t<span class="error-msg">Network problem, retry in some minutes</span>\n\t\t<img src="./assets/star.png" class="star-img">\n\t</div>\n\n</div>\n',t.firstChild}()},function(t,s,e){"use strict";e.r(s),s.default=function(){const t=document.createElement("div");return t.innerHTML='<div class="view result-view">\n\n\t<div class="row intro">\n\t\t\x3c!--<span class="description">Your generated music piece</span>--\x3e\n\t</div>\n\n\t<div class="row sheet has-icons">\n\t\t<img src="./assets/fish.png" class="fish-img">\n\t\t\x3c!-- sheet will be inserted here --\x3e\n\t\t<div id="sheet"></div>\n\t</div>\n\n\t<div class="row actions">\n\t\t<button class="btn btn-play" id="play-btn">Play</button>\n\t\t<button class="btn btn-dw" id="dw-btn">Download</button>\n\t\t<button class="btn btn-reset" id="reset-btn">Restart</button>\n\t</div>\n\n</div>\n',t.firstChild}()}]]);